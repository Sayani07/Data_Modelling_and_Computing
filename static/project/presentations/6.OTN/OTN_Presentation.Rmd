---
title: "The College Students' Relationship with Food"
author: "Team OTN"
date: "May 21, 2018"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    self_contained: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r xaringan-themer, include = FALSE}
#devtools::install_github("gadenbuie/xaringanthemer")
library(xaringanthemer)
solarized_light(
  extra_css = list(
    ".small" = list("font-size" = "70%")
  )
)
```



```{r setup, include=FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  collapse = TRUE,
  echo=FALSE,
  comment = "",
  fig.height = 4,
  fig.width = 8,
  fig.align = "center",
  cache = FALSE
)
library(tidyverse)
library(gridExtra)

#Text Analysis Packages
library(tidytext)
library(gutenbergr)

#Data visualisation packages
library(visdat)
library(naniar)
library(broom)
library(forcats)

#Function for pretty plotting
#Function taken from https://stackoverflow.com/questions/13649473/add-a-common-legend-for-combined-ggplots
#Code attributed to https://github.com/tidyverse/ggplot2/wiki/Share-a-legend-between-two-ggplot2-graphs
g_legend<-function(a.gplot){
  tmp <- ggplot_gtable(ggplot_build(a.gplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)}

#food <- read_csv("clean_food.csv")

```

```{r Cleaning up Comfort Foods}
food <- read.csv("food_coded.csv")

#Cleaning up food
CF_clean <- food %>%
	#consolidate synonymous terms
	mutate(comfort_food = sub("(mac-n-cheese|mac n cheese|macaroni and cheese|mac & cheese)", "mac and cheese", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("(chocolate bar|kit kat)", "candy bars", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("(Chipotle|Moe's|moes|mcdonalds)", "fast food", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("(sandwhich|subs)", "sandwich", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("(dr. pepper|pepsi)", "soda", comfort_food, ignore.case=TRUE)) %>%
	#gather plurals/singlular terms
	mutate(comfort_food = sub("(brownie|brownies)", "brownies", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("(milkshake|milkshakes)", "milkshakes", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("(burger|burgers)", "burgers", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("(donuts|doughnuts)", "donuts", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("chocolates", "chocolate", comfort_food, ignore.case=TRUE)) %>%
	#correct misspellings
	mutate(comfort_food = sub("(crea|cream)", "cream", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("fires", "fries", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("nuggs", "nuggets", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("pretzals", "pretzels", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("dessets", "desserts", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("lasagne", "lasagna", comfort_food, ignore.case=TRUE),
				 comfort_food = sub(" grandma homemade chocolate cake anything homemade", "homemade chocolate cake", comfort_food, ignore.case=TRUE),
				 comfort_food = sub("Grandma's Chinese, Peruvian food from back home", "homemade chinese and peruvian", comfort_food, ignore.case=TRUE)) %>%
	#remove redundant terms/alter nan string to "none"
	mutate(comfort_food = sub("nan", "none", comfort_food),
				 comfort_food = sub("( dishes| \\( any kinds of noodle\\)|deli | foods)", "", comfort_food, ignore.case=TRUE))

food <- CF_clean
```

```{r Cleaning up Comfort Food Reasons}
CR_clean <- food %>%
	#Recoding phrases that mean the same thing
  mutate(comfort_food_reasons = sub(paste("(Just cause",
                                          "No reasons",
                                          "we dont have comfort",
                                          "nan",
                                          "None, i don't eat comfort food. I just eat when i'm hungry.)", sep = "|"),
                                    "none", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub(paste("I eat comfort food when im stress out from school\\(finals week\\)",
         																 "I am always stressed out",
         																 "stres",
         																 "stress",
         																 "stressed", sep = "|"),
                                    "stress", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub(paste("Usually if I'm sad",
                                          "when I`m sad, or when i am dealing with personal family issues.",
                                          "my boyfriend sometimes makes me sad",
         																  "and then when I am sad to comfort me.",
         																  "when i am sad",
         																  "sad",
         																  "sadness",
         																  sep = "|"),
                                    "sad", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub(paste("A long day",
         																 "when I feel tired", sep = "|"),
         													 "tired", comfort_food_reasons, ignore.case = TRUE),
  			 comfort_food_reasons = sub(paste("boredom",
                                          "bored",
                                          "Bordem",
                                          "Boredom usually",
                                          "I usually only eat comfort food when I'm bored, if i am doing something, i can go for hours without eating",
                                          "I usually only eat comfort foods when I am bored.",
         																  "and bored when I am in my apartment.",
         																  "Boredom!", sep = "|"),
                                    "bored", comfort_food_reasons, ignore.case = TRUE),
  			 comfort_food_reasons = sub(paste("cold weather",
                                          "winter", sep = "|"),
                                    "weather", comfort_food_reasons, ignore.case = TRUE),
  			 comfort_food_reasons = sub(paste("or just craving a cheat meal",
         																  " or craving"),
         													 "craving", comfort_food_reasons, ignore.case = TRUE),
  			  comfort_food_reasons = sub(paste("they are yummy",
                                          "They taste better than other food.",
                                          " and if it has a good taste.",
         																 "they are some of my favorite foods", sep = "|"),
                                    "enjoyable", comfort_food_reasons, ignore.case = TRUE),
  			 comfort_food_reasons = sub("not feeling well", "sick", comfort_food_reasons, ignore.case = TRUE),
  			 comfort_food_reasons = sub(paste("Premenstrual syndrome.",
         																 "being in your period", sep = "|"),
         													 "period", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("They are a pickme up.", "energy", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("They are easy to make", "convenient", comfort_food_reasons, ignore.case = TRUE),
  			 comfort_food_reasons = sub(" I will also eat them when I am happy to celebrate", "celebration", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("and long bus rides for softball", "sports", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub(" watching TV I desire \"comfort food\"", "entertainment", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("Food smell or look good", "appealing", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("physical activity", "sport", comfort_food_reasons, ignore.case = TRUE),
  			 comfort_food_reasons = sub("college as whole", "school", comfort_food_reasons, ignore.case = TRUE)) %>%
	#Removing meaningless phrases
	mutate(comfort_food_reasons = sub(paste("All of the above; ",
         																 "I do not really eat \"comfort food\" but I guess ",
         																 "Mostly ", sep = "|"),
         													 "", comfort_food_reasons, ignore.case = TRUE)) %>%
	#Recoding synonymous terms and phrases
	mutate(comfort_food_reasons = sub("(or with friends|friends|social event|When i'm  eating with my close friends)", "social", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("(celebrate|celebration)", "celebration", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("(craving|cravings)", "cravings", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("(or depressed.|depression|depressed)", "depressed", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("(anxiety|anxiousness)", "anxiety", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("(happy|happiness)", "happiness", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("(hungry|hunger| and just being hungry in general.)", "hunger", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("(laziness|lazy|lazyniss)", "laziness", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("(loneliness|lonely)", "loneliness", comfort_food_reasons, ignore.case = TRUE),
         comfort_food_reasons = sub("(late night|nighttime)", "nighttime", comfort_food_reasons, ignore.case = TRUE))

food <- CR_clean
```




```{r Cleaning up Professions}
#Recoding data
prof_clean <- food %>%
  mutate(eating_out=recode(eating_out,"1"="0","2"="1-2","3"="2-3","4"="3-5","5"="every day")) %>%
  mutate(Gender=recode(Gender,"1"="Female","2"="Male")) %>%
#Setting levels for ordering of categorical variables  
  mutate(pay_levels=pay_meal_out) %>%
  mutate(cook_levels=cook) %>%
  mutate(parents_cook_levels=parents_cook) %>%
  mutate(cook=recode(cook,"1"="every day","2"="two times a week","3"="not often","4"="holidays only","5"="never")) %>%
  mutate(pay_meal_out=recode(pay_meal_out,"1"="[0,5]","2"="(5,10]","3"="(10,20]","4"="(20,30]","5"="(30,40]","6"="More than $40")) %>%
  mutate(parents_cook=recode(parents_cook,"1"="almost every day","2"="2-3","3"="1-2","4"="holidays only","5"="never")) %>%
  mutate(pay_meal_out=fct_reorder(pay_meal_out,pay_levels)) %>%
  mutate(cook=fct_reorder(cook,cook_levels)) %>%
  mutate(parents_cook=fct_reorder(parents_cook,parents_cook_levels))

#Cleaning profession data
prof<-c("fProfCat","mProfCat")

prof_clean <- prof_clean %>%
  #Changing similar answers into standard values
  mutate(fProfCat=father_profession)%>%
  mutate(mProfCat=mother_profession)%>%
  mutate_at(.funs=(funs(str_to_lower(.))),prof) %>%
  mutate_at(.funs=(funs(sub(".*(not sure|idk|deceased|retired).*", NA, .))),prof) %>%
  mutate_at(.funs=(funs(sub(".*(business|account|banker|sales|own|realtor|insurance|real estate|self|contract|light|appraiser|market|secretary|assistant).*", "business", .))),prof) %>%
  mutate_at(.funs=(funs(sub(".*(home|dead beat|house|nothing).*", "unemployed", .))),prof) %>%
  mutate_at(.funs=(funs(sub(".*(optometrist|therapist|dentist|pharmaceutical|doctor|nurse|med).*", "medical", .))),prof) %>%
  mutate_at(.funs=(funs(sub(".*(engineer|it|bio|ford|research|periodontist).*", "stem", .))),prof) %>%
  mutate_at(.funs=(funs(sub(".*(mechanic|assembler|tech|construction|worker|landscaping|weld|handy).*", "trade", .))),prof) %>%
  mutate_at(.funs=(funs(sub(".*(manager|vp|pres|director|commissioner|cfo|supervisor|ceo|head).*", "management", .))),prof) %>%
  mutate_at(.funs=(funs(sub(".*(police|fire|driver|officer|guard|transport|counsel|provide|care|librarian).*", "public servant", .))),prof) %>%
   mutate_at(.funs=(funs(sub(".*(teacher|prof|coach|principal|school).*", "teaching", .))),prof)

prof_clean[!is.na(prof_clean$fProfCat) & !prof_clean$fProfCat %in%
         c("business","unemployed","medical","stem","trade","management","public servant","teaching"), "fProfCat"] <- "other"
prof_clean[!is.na(prof_clean$mProfCat) & !prof_clean$mProfCat %in%
         c("business","unemployed","medical","stem","trade","management","public servant","teaching"), "mProfCat"] <- "other"

prof_clean$father_profession <- prof_clean$fProfCat
prof_clean$mother_profession <- prof_clean$mProfCat

prof_clean <- prof_clean %>%
  select(-fProfCat, -mProfCat)

food <- prof_clean
```

```{r Cleaning up Weight}
weight_clean <- food %>%
	mutate(weight = gsub("([A-Za-z])* *([[:punct:]])*","",weight))

food <- weight_clean
```

```{r Cleaning: Adjusting Data Types}
food$Gender = as.factor(food$Gender)
food$comfort_food = as.character(food$comfort_food)
food$comfort_food_reasons = as.character(food$comfort_food_reasons)
food$calories_day = as.factor(food$calories_day)
food$self_perception_weight = as.factor(food$self_perception_weight)
food$weight = as.numeric(food$weight)
```


layout: true
class: middle

---
# Outline

- Data Description

- Data tidying process

- Visualizations and analysis

- Conclusions

- References

---
# Data Description
- Data includes around 125 college students' food habits, including their food choices, preferences, nutrition, etc.

- Our aim is to understand the eating habits of college students and the factors behind these habits. 

- Data sourced from https://www.kaggle.com/borapajo/food-choices
---

# Posed Questions

- How does a college student's self-imposed importance of calories and their self-perception of weight affect their actual weight?

- Why do college students eat comfort food?

- Which comfort foods are popular amongst students?

- Does a parent's profession affect their home-cooking frequency?

- Does a parent's home-cooking frequency affect a student's eating habits?

- Does an individual's health affect how rewarding they find life?

---

# Cleaning

- Multi-choice and extended response data

- Drop null values

- Spelling Mistakes

- Synonymous Terms

- Different Tenses

- Redundant Terms

- Recoding multi-choice

- Profession data

---
layout:false

# Importance of calories
```{r Importance of Calories Distribution, fig.height = 5, fig.width = 10}
food %>%
	select(Gender, calories_day) %>%
	filter(calories_day != "NaN")%>%
	ggplot(aes(x=Gender, fill = calories_day)) + 
  geom_bar(stat = "count", position = "fill") +
	labs (y = "Proportion", title = "Calorie Importance Distribution", fill = "Importance Perception") +
	scale_fill_manual(labels = c("(2) Not Important", "(3) Moderately Important", "(4) Very Important"),
										values = c("coral3","chartreuse3","dodgerblue3")) +
	theme(legend.position = "bottom")
```
- More females
- Higher percentage of males who view calories as "very important" and 
"not important"
---

layout: true
class: middle

---
# Variables affecting Weight
+ What variables affect weight?
+ Importance of calories vs weight
+ Self perception of weight vs weight


---
layout: false

## Importance of calories vs weight
```{r Variables Affecting Weight: Plot, fig.height = 5, fig.width = 10}
a6 <- food %>%
	select(Gender, calories_day, weight) %>%
	filter(calories_day != "NaN")%>%
  mutate(weight = weight * 0.4535924) %>%
	ggplot(aes(x=calories_day, y=weight)) +
  geom_violin(draw_quantiles = c(0.25,0.5,0.75)) +
  facet_grid(~Gender) + ggtitle("Importance of calories vs weight")

a7 <- food %>%
	select(Gender, self_perception_weight, weight) %>%
	filter(self_perception_weight != "NaN") %>%
  mutate(weight = weight * 0.4535924) %>%
	ggplot(aes(x=self_perception_weight, y=weight)) +
  geom_violin(draw_quantiles = c(0.25,0.5,0.75)) + facet_grid(~Gender) +
  ggtitle("Self perception of weight vs weight")
a6
```
- Trend in Males
- Increasing range in males

---
## Self Perception of weight vs weight
```{r, fig.height = 5, fig.width = 10}
a7
```
- Higher number = perceived as more overweight
- Self-perception reflects weight
- Large range
- Limited to absolute value

---


layout: true
class: middle, center

---

# Comfort Food Analysis
---

layout: true
class: middle

---

## What is emotional eating?
- **emotional eating:** "an increase in food intake in response to negative emotions" [(Definition)](https://doi.org/10.1016/j.appet.2006.10.005)
- Typically a coping mechanism for many students!
- But what kind of foods do college students consume, and for what reasons?

---
layout: false

## "What kind of foods do students like to eat for comfort?"
- Text analysis was conducted on the short-response columns. Students listed:
  - the foods they liked to eat
  - reasons why they typically ate
- Token Frequencies were calculated by gender
- Quantiles were calculated to determine the cutoffs for terms of interest

```{r Comfort Foods Analysis}
comf_food <- food %>%
  select(Gender, comfort_food)

cf_tokens <- comf_food %>%
	group_by(Gender) %>%
  unnest_tokens(word, comfort_food) %>%         #tokenise
  anti_join(stop_words) %>%                     #removes stop words
  count(word, sort=TRUE)

cf_token_total <- cf_tokens %>%
  group_by(word) %>%
  mutate(total = sum(n))

top_foods <- cf_token_total %>%
  filter(total > quantile(cf_token_total$total, probs = 0.9)) %>%
  select(word) %>%
  unique()

cf_fem <- cf_tokens %>%
  filter(Gender == "Female")

cf_mal <- cf_tokens %>%
  filter(Gender == "Male")
```

```{r CF: Quantile Table, echo = TRUE}
Frequency <- c(quantile(cf_token_total$total,probs = 0.9), quantile(cf_fem$n, probs = 0.9),
           quantile(cf_mal$n, probs = 0.9))
Group <- c("All", "Female", "Male")
top_foods_table <- cbind(Group, Frequency)
knitr::kable(top_foods_table, format = "html")
```

---

## Plot: Comfort Foods by Groups
```{r CF Analysis: Plots}
#Plotting 90th Percentile comfort food tokens: Total
cf_1 <- cf_tokens %>% filter(word %in% top_foods$word) %>%
  ggplot(aes(x=fct_reorder(word, n), y=n, fill = as.factor(Gender))) + geom_col(position = "dodge") +
  labs(x = "", title = "Both Genders", fill = "Gender") + coord_flip() + theme(legend.position = "bottom") +
  scale_fill_manual(labels = c("Female", "Male"), values = c("firebrick2", "royalblue3"))

#Plotting comfort food tokens by gender (Female)
cf_2 <- cf_tokens %>% filter(Gender == "Female" & n >= quantile(cf_fem$n, probs = 0.9)) %>%
  ggplot(aes(x=fct_reorder(word, n), y=n, fill = as.factor(Gender))) + geom_col() +
  labs(x = "", title = "Females") + coord_flip() + theme(legend.position = "none") +
  scale_fill_manual(values = c("firebrick2"))

#Plotting comfort food tokens by gender (Male)
cf_3 <- cf_tokens %>% filter(Gender == "Male" & n >= quantile(cf_mal$n, probs = 0.9)) %>%
  ggplot(aes(x=fct_reorder(word, n), y=n, fill = as.factor(Gender))) + geom_col() +
  labs(x = "", title = "Males") + coord_flip() + theme(legend.position = "none") +
  scale_fill_manual(values = c("royalblue3"))
```

```{r CF Analysis: Plot Formatting, fig.width=10, fig.height=6}
cf_legend<-g_legend(cf_1)

grid.arrange(arrangeGrob(cf_1 + theme(legend.position = "none"),
                         cf_2,
                         cf_3,
                         nrow=1),
             cf_legend, nrow=2,
             heights=c(8, 1), top = grid::textGrob("90th Percentile Comfort foods amongst:",
                                                                gp=grid::gpar(fontsize=15,font=2)))
```
---

layout: true
class: middle

---

- Ice cream was split into two tokens
  - Similar counts in the first graph indicate that both tokens typically referred to ice cream
  - Ice Snapps was an exception
- Primarily sweet foods (Ice Cream, Pizza, Chocolate, Cookies) were preferred by more female students than male students
- Male students preferred both sweet and savoury foods.
- The top foods were preferred by a greater proportion of female students
  - female students' preferences accounted for 65.8% of the top foods listed
  - statistic reflects the general proportion of comfort foods listed by each gender
  - female respondents tended to list more foods than male respondents (64.2%)
  
---

## "Why do students eat comfort food?"
- Once again, the short-response column was tokenised and frequencies were calculated
- The sentiment analysis conducted used the AFINN lexicon
  - Due to the low number of total sentiments captured in the dataset, all captured sentiments were used in plotting
```{r Comfort Food Reasons}
comf_reason <- food %>%
  select(Gender, comfort_food_reasons)

cr_tokens <- comf_reason %>%
  group_by(Gender) %>%
  unnest_tokens(word, comfort_food_reasons) %>%
  anti_join(stop_words) %>%
  count(word, sort=TRUE)

cr_tokens_total <- cr_tokens %>%
  group_by(word) %>%
  mutate(total = sum(n))

top_reasons <- cr_tokens_total %>%
  filter(total > quantile(cr_tokens_total$n, probs = 0.9)) %>%
  select(word) %>%
  unique()

cr_fem <- cr_tokens %>%
  filter(Gender == "Female")

cr_mal <- cr_tokens %>%
  filter(Gender == "Male")
```

```{r CR: Quantile Tables, echo = TRUE}
Frequency <- c(quantile(cr_tokens_total$total,probs = 0.9),
           quantile(cr_fem$n, probs = 0.9),
           quantile(cr_mal$n, probs = 0.9))
Group <- c("All", "Female", "Male")

top_reasons_table <- cbind(Group, Frequency)
knitr::kable(top_reasons_table, format = "html")
```

---

layout: false

## Plot: Comfort Food Reasons

```{r CR Analysis: Plotting}
#Plotting 90th Percentile comfort food tokens: Total
cr_1 <- cr_tokens %>% filter(word %in% top_reasons$word) %>%
  ggplot(aes(x=fct_reorder(word, n), y=n, fill = as.factor(Gender))) + geom_col(position = "dodge") +
  labs(x = "", title = "Both Genders", fill = "Gender") + coord_flip() + theme(legend.position = "bottom") +
  scale_fill_manual(labels = c("Female", "Male"), values = c("firebrick2", "royalblue3"))

#Plotting comfort food tokens by gender (Female)
cr_2 <- cr_tokens %>% filter(Gender == "Female" & n >= quantile(cr_fem$n, probs = 0.9)) %>%
  ggplot(aes(x=fct_reorder(word, n), y=n, fill = as.factor(Gender))) + geom_col() +
  labs(x = "", title = "Female") + coord_flip() + theme(legend.position = "none") +
  scale_fill_manual(labels = c("Female"), values = c("firebrick2"))

#Plotting comfort food tokens by gender (Male)
cr_3 <- cr_tokens %>% filter(Gender == "Male" & n >= quantile(cr_mal$n, probs = 0.9)) %>%
  ggplot(aes(x=fct_reorder(word, n), y=n, fill = as.factor(Gender))) + geom_col() +
  labs(x = "", title = "Male") + coord_flip() + theme(legend.position = "none") +
  scale_fill_manual(labels = c("Male"), values = c("royalblue3"))
```

```{r CR Analysis: Plot Formatting, fig.width=10, fig.height=6}
cr_legend<-g_legend(cr_1)

grid.arrange(arrangeGrob(cr_1 + theme(legend.position = "none"),
                         cr_2, cr_3, nrow=1,
												 top =grid::textGrob("90th Percentile Comfort Food Reasons amongst:",
                                                                gp=grid::gpar(fontsize=15,font=2))),
						 cr_legend,
						 nrow=2,
             heights=c(16, 1))
```

---

layout: true
class: middle

---

## Comfort Food Reasons

- Respondents of both genders cited boredom as the top reason
- Further reasons observe a different split in proportions
  - Female survey respondents cited stress as a reason to eat for comfort 3 times more frequently than males
- After Boredom, the next highest reasons were all emotional

- While more females cited the top reasons (Boredom, Sadness and Stress) than males, the next three top reasons were all cited by more males than females
  - This included Happiness, Anger and Hunger
  - Males reported that they were more likely to eat out of happiness than females, but they were also more likely to cite eating out of anger

---

layout: false

## Plot: Sentiment Scores

```{r Sentiment Analysis: Analysis}
cr_sentiment <- cr_tokens %>% 
  inner_join(get_sentiments("afinn"), by = "word")
cr_sentiment_total <- cr_sentiment %>%
  group_by(word) %>%
  mutate(total = sum(n))
```

```{r Sentiment Analysis: Plotting}
#Plotting 90th Percentile comfort food tokens: Total
cs_1 <- cr_sentiment_total %>%
  ggplot(aes(x=fct_reorder(word, n), y=n, fill = score)) + geom_col() +
  labs(x = "", title = "Both Genders", fill = "Score") + coord_flip() + theme(legend.position = "none") +
  scale_fill_gradient(low = "royalblue4", high = "bisque")

#Plotting comfort food tokens by gender (Female)
cs_2 <- cr_sentiment %>% filter(Gender == "Female") %>%
  ggplot(aes(x=fct_reorder(word, n), y=n, fill = score)) + geom_col() +
  labs(x = "", title = "Female", fill = "Score") + coord_flip() + theme(legend.position = "none") +
  scale_fill_gradient(low = "royalblue4", high = "bisque")

#Plotting comfort food tokens by gender (Male)
cs_3 <- cr_sentiment %>% filter(Gender == "Male") %>%
  ggplot(aes(x=fct_reorder(word, n), y=n, fill = score)) + geom_col() +
  labs(x = "", title = "Male", fill = "Score") + coord_flip() + theme(legend.position = "bottom") +
  scale_fill_gradient(low = "royalblue4", high = "bisque")
```

```{r Sentiment Analysis: Plot Formatting, fig.width=10, fig.height=6}
cs_legend<-g_legend(cs_3)

grid.arrange(arrangeGrob(cs_1, cs_2, cs_3 + theme(legend.position = "none"), nrow=1,
						 						top = grid::textGrob("Sentiment distributions of reasons amongst:",
                                  gp=grid::gpar(fontsize=15,font=2))),
             cs_legend, nrow=2,
             heights=c(16, 2))
```

---

layout: true
class: middle

---

## Sentiment Analysis on Reasons

- A vast majority of the reasons reported were negative
  - Top reasons Boredom and Sad(ness) rated -2 by the AFINN sentiment lexicon
    - Negative values [indicate an "intrinsic averseness"](http://www2.imm.dtu.dk/pubdb/views/publication_details.php?id=6010), or negativity of a term/emotion
- Female responses accounted for a greater variety of emotions and mental states than male responses
- The large skew of negatively classified emotions supports the idea that many eat for intrinsically negative emotions and reasons

---


layout: true
class: middle, center

---

# Parent's effect on students' eating habits

---

layout: false
#  Effect of a parent's profession on their home-cooking frequency
```{r Parents Cooking Given Profession: Plots, fig.width = 10}
pp1<-food %>% select(father_profession,parents_cook) %>%
  group_by(father_profession) %>% count(parents_cook) %>%
  spread(father_profession,n) %>%
  mutate_at(.funs=(funs(./sum(.,na.rm=TRUE))),c(2:10)) %>%
  gather("father_profession", "prop", business,unemployed,medical,stem,trade,management,`public servant`,teaching,other) %>%
  mutate(parents_cook=factor(parents_cook,levels=c("almost every day","2-3","1-2","never")))%>%
  ggplot(aes(x=parents_cook, y=prop, fill=father_profession)) +
  geom_bar(stat="identity", position="dodge") +
  labs(x="Freq parents cooked (per week)",y="Proportion", title="Father's profession") +
  scale_fill_brewer(name="Profession",palette="Paired") +
  theme(legend.position = "bottom")

pp2<-food %>% select(mother_profession,parents_cook) %>%
  group_by(mother_profession) %>% count(parents_cook) %>%
  spread(mother_profession,n) %>%
  mutate_at(.funs=(funs(./sum(.,na.rm=TRUE))),c(2:10)) %>%
  gather("mother_profession", "prop", business,unemployed,medical,stem,trade,management,`public servant`,teaching,other) %>%
  mutate(parents_cook=factor(parents_cook,levels=c("almost every day","2-3","1-2","never")))%>%
  ggplot(aes(x=parents_cook, y=prop, fill=mother_profession)) +
  geom_bar(stat="identity", position="dodge") +
  labs(x="Freq parents cooked (per week)",y="Proportion", title="Mother's profession") +
  scale_fill_brewer(palette="Paired") +
  theme(legend.position = "none")
```

```{r Parents Cooking Given Profession: Plot Formatting, fig.width = 10}
p1_legend<-g_legend(pp1)

grid.arrange(arrangeGrob(pp1 + theme(legend.position = "none"),
  pp2,nrow=1),
  p1_legend, nrow=2,
  heights=c(20, 5), top = grid::textGrob("Parents cooking given their profession",
  gp=grid::gpar(fontsize=15,font=2)))
```

.small[- Most parents cooked almost every day regardless of profession 
- Exception: Fathers in teaching and mothers in stem tended to cook less frequently
- Unemployed parents or those who worked in management were more likely to cook

- The data has not been analysed based on both parent's professions concurrently so similarities between the different professions for mother and father may be from pairings]

---
#  Effect of a parent's home-cooking frequency on a student's cooking and eating out frequency
```{r Student Cooking Frequency given Parents Cooking History: Plots, fig.width = 10}
#Student cooks given parents cooked
pc1<-food %>% filter(!is.na(cook)) %>%
  select(parents_cook,cook,Gender) %>%
  group_by(Gender,parents_cook) %>%
  count(cook) %>%
  spread(parents_cook,n) %>%
  mutate_at(.funs=(funs(./sum(.,na.rm=TRUE))),c(2:4)) %>%
  gather("parents_cook", "prop", `almost every day`,`2-3`,`1-2`) %>%
  mutate(parents_cook=factor(parents_cook,levels=c("almost every day","2-3","1-2","holidays only")))%>%
  mutate(cook=factor(cook,levels=c("every day","two times a week","not often","holidays only","never")))%>%
  ggplot(aes(x=cook, y=prop, fill=parents_cook)) + 
  geom_bar(stat="identity", position="dodge") +
  facet_grid(Gender~.) +
  labs(x="Freq student cooks",y="Proportion",title="How often student cooks") +
  scale_fill_brewer(name="Freq parents cooked (per week)", palette="Paired")+
  theme(legend.position="bottom")

#Student eats out given parents cooked
pc2<-food %>% filter(!is.na(eating_out)) %>%
  select(parents_cook,eating_out,Gender) %>%
  group_by(Gender,parents_cook) %>%
  count(eating_out) %>%
  spread(parents_cook,n) %>%
  mutate_at(.funs=(funs(./sum(.,na.rm=TRUE))),c(2:4)) %>%
  gather("parents_cook", "prop", `almost every day`,`2-3`,`1-2`) %>%
  mutate(parents_cook=factor(parents_cook,levels=c("almost every day","2-3","1-2","holidays only")))%>%
  ggplot(aes(x=eating_out, y=prop, fill=parents_cook)) + 
  geom_bar(stat="identity", position="dodge") +
  facet_grid(Gender~.) +
  labs(x="Freq student eats out (per week)",y="Proportion",title="How often student eats out") +
  scale_fill_brewer(palette="Paired")+
  theme(legend.position="none")
```

```{r Student Cooking Frequency given Parents Cooking History: Plot Formatting, fig.width = 10}
p2_legend<-g_legend(pc1)

grid.arrange(arrangeGrob(pc1 + theme(legend.position = "none"),
  pc2,nrow=1),
  p2_legend, nrow=2,
  heights=c(10, 1), top = grid::textGrob("Given frequency parents cooked:",
  gp=grid::gpar(fontsize=15,font=2)))
```
.small[- The proportion where parents never cooked is always 1 as only 1 student had this answer so it was excluded from the plots to prevent misrepresentation of data

- Most students, regardless of gender, do not cook very often 
- Females do cook more frequently than males, regardless of whether their parents cooked for them frequently as children

- Most students will eat out during the week, at least 1-2 times, regardless of whether their parents cooked for them]

---
# How does healthiness affect outlook on life?

```{r Health on Happiness: Plot, fig.width = 10, fig.height = 5}
ggplot(data = food, aes(x = healthy_feeling, y= life_rewarding)) + 
  geom_jitter() + geom_smooth() +
  labs(x = "Healthy Feeling", y = "Life Rewarding", title = "Do healthy people find life more rewarding?  (Jittered Points)")
```
- Upwards trend between how healthy a student feels and how rewarding they find life
  - Large variance and many outliers; not exact proof

---

layout: true
class: middle

---
# Conclusions

- Most students place moderate importance on caloric consumption

- Boredom is the top reason behind consuming comfort food
  - Most reasons are negative
  
- Most students don't cook much, irrespective of parents' cooking habits

- Healthiness appears to correlate with a rewarding life

---
# References

- Food choices and preferences of college students survey (2017)
  - Retrieved from https://www.kaggle.com/borapajo/food-choices
  
- Spoor, S., Bekker, M., Strien, T., & Heck, G. (2006). Relations between negative affect, coping, and emotional eating. Appetite, 48(3), 368-376. doi:10.1016/j.appet.2006.10.005

- Hadley, W. and Garrett, G. (2016). R for Data Science

